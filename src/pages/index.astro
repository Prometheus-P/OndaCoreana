---
import BaseLayout from '../layouts/BaseLayout.astro';
import NewsletterForm from '../components/newsletter/NewsletterForm.astro';
import AdSlot from '../components/ads/AdSlot.astro';
import ContentCard from '../components/ui/ContentCard.astro';
import FAQSection from '../components/ui/FAQSection.astro';
import JsonLd from '../components/seo/JsonLd.astro';
import { getRecentContent } from '../utils/content-helpers';

// Obtener contenido reciente
const recentDramas = await getRecentContent('dramas', 4);
const recentKpop = await getRecentContent('kpop', 4);
const recentNoticias = await getRecentContent('noticias', 6);

// FAQ data for AEO optimization (10 questions for better AEO score)
const homepageFaq = [
  {
    question: "¿Qué es OndaCoreana?",
    answer: "OndaCoreana es el portal líder en español sobre cultura coreana, dedicado a la comunidad latina. Ofrecemos reseñas de K-Dramas, perfiles de artistas K-Pop, noticias actualizadas y guías completas sobre Corea del Sur."
  },
  {
    question: "¿Dónde puedo ver K-Dramas con subtítulos en español?",
    answer: "Puedes ver K-Dramas con subtítulos en español en plataformas como Netflix, Viki y Kocowa. Netflix ofrece una amplia selección con doblaje latino, mientras que Viki tiene la biblioteca más extensa con subtítulos creados por fans."
  },
  {
    question: "¿Cuáles son los K-Dramas más populares en Latinoamérica?",
    answer: "Los K-Dramas más populares en Latinoamérica incluyen El Juego del Calamar, Crash Landing on You, Goblin y Reina de las Lágrimas. Estos dramas han cautivado a millones de espectadores latinos con sus historias emocionantes."
  },
  {
    question: "¿Cómo puedo aprender coreano desde cero?",
    answer: "Puedes empezar aprendiendo el alfabeto Hangul, que se puede dominar en pocas horas. Luego, utiliza apps como Duolingo o Talk To Me In Korean, y practica viendo K-Dramas con subtítulos. En OndaCoreana tenemos guías completas para principiantes."
  },
  {
    question: "¿Qué grupos de K-Pop son los más famosos actualmente?",
    answer: "Los grupos de K-Pop más famosos incluyen BTS, BLACKPINK, Stray Kids, NewJeans y aespa. BTS ha roto récords mundiales, mientras que BLACKPINK es el grupo femenino más seguido. La nueva generación está liderada por NewJeans y Stray Kids."
  },
  {
    question: "¿Cuánto cuesta una suscripción a Netflix o Viki para ver K-Dramas?",
    answer: "Netflix tiene planes desde $6.99 USD/mes (básico) hasta $22.99 USD/mes (premium). Viki ofrece contenido gratis con anuncios o Viki Pass desde $4.99 USD/mes. Ambas plataformas ofrecen pruebas gratuitas para nuevos usuarios."
  },
  {
    question: "¿Qué significa Hallyu o la Ola Coreana?",
    answer: "Hallyu (한류) significa literalmente 'ola coreana' y se refiere al fenómeno global de la cultura pop surcoreana. Incluye K-Dramas, K-Pop, cine coreano, gastronomía y moda. Este movimiento cultural comenzó en los años 90 y ha crecido exponencialmente."
  },
  {
    question: "¿Cuál es la diferencia entre un K-Drama y un dorama?",
    answer: "K-Drama se refiere específicamente a dramas de Corea del Sur, mientras que 'dorama' es un término general para dramas asiáticos (japoneses, chinos, taiwaneses, etc.). Los K-Dramas suelen tener 16-20 episodios y una sola temporada con historia completa."
  },
  {
    question: "¿Cómo puedo viajar a Corea del Sur desde Latinoamérica?",
    answer: "Para viajar a Corea del Sur necesitas pasaporte vigente y, dependiendo de tu país, una visa K-ETA. Los vuelos desde CDMX, São Paulo o Lima tienen escalas en EE.UU. o Asia. El costo promedio es $1,200-2,000 USD ida y vuelta. La mejor época para visitar es primavera u otoño."
  },
  {
    question: "¿Qué es un idol de K-Pop y cómo se entrenan?",
    answer: "Un idol de K-Pop es un artista entrenado por una agencia de entretenimiento coreana. El entrenamiento dura 2-7 años e incluye canto, baile, actuación e idiomas. Las principales agencias son HYBE (BTS), SM (aespa), JYP (Stray Kids) y YG (BLACKPINK)."
  }
];
---

<BaseLayout
  title="OndaCoreana - K-Dramas, K-Pop y Cultura Coreana en Español"
  description="Tu fuente definitiva de información sobre K-Dramas, K-Pop y cultura coreana en español. Noticias, guías, reseñas y más para la comunidad latina."
>
  <Fragment slot="head">
    <JsonLd
      schema={[
        { type: 'WebSite' },
        { type: 'Organization' },
        { type: 'FAQPage', questions: homepageFaq },
      ]}
    />
  </Fragment>

  <!-- Hero Section -->
  <section
    class="section-shell"
    style="--section-bg: linear-gradient(135deg, color-mix(in srgb, var(--md-color-primary) 80%, #111111) 0%, color-mix(in srgb, var(--md-color-tertiary) 70%, transparent) 60%); --section-color: var(--md-color-on-primary);"
  >
    <div class="section-shell__inner items-center text-center">
      <p class="chip" style="--chip-bg: color-mix(in srgb, var(--md-color-primary) 35%, transparent); --chip-color: var(--md-color-on-primary); margin: 0 auto;">
        Cultura K en español
      </p>
      <h1 class="text-4xl font-bold sm:text-5xl lg:text-6xl" style="margin-top: var(--md-spacing-md); color: inherit;">
        Tu portal de cultura coreana
      </h1>
      <p style="max-width: 42rem; margin: var(--md-spacing-md) auto 0; color: color-mix(in srgb, var(--md-color-on-primary) 80%, transparent);">
        Descubre los mejores K-Dramas, mantente al día con el K-Pop y sumérgete en la cultura coreana con guías, reseñas y noticias pensadas para la comunidad latina.
      </p>
      <div class="mt-10 flex flex-col items-center justify-center gap-4 sm:flex-row">
        <a href="/dramas" class="btn btn--primary">
          Ver K-Dramas populares
        </a>
        <a
          href="/kpop"
          class="btn btn--outline"
          style="border-color: rgba(255, 255, 255, 0.6); color: var(--md-color-on-primary);"
        >
          Conocer artistas K-Pop
        </a>
      </div>
    </div>
  </section>

  <!-- Quick Answers Summary for AEO -->
  <section class="section-shell" style="--section-bg: var(--md-color-surface);">
    <div class="section-shell__inner">
      <h2 class="text-2xl font-semibold mb-6" style="color: var(--md-color-on-surface);">
        ¿Qué encontrarás en OndaCoreana?
      </h2>
      <p class="mb-6" style="color: var(--md-color-on-surface-variant); max-width: 48rem; line-height: 1.7;">
        <strong>OndaCoreana es tu guía completa de cultura coreana en español.</strong> Aquí puedes descubrir los mejores K-Dramas para ver en Netflix y Viki, conocer a los artistas de K-Pop más populares como BTS y BLACKPINK, y encontrar guías prácticas para aprender coreano o planificar tu viaje a Corea del Sur.
      </p>

      <!-- Definition List for Key Terms -->
      <h3 class="text-xl font-semibold mb-4" style="color: var(--md-color-on-surface);">
        Glosario: Términos clave de la cultura coreana
      </h3>
      <dl class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3 mb-8" style="color: var(--md-color-on-surface);">
        <div class="p-4" style="background-color: var(--md-color-surface-container); border-radius: var(--md-shape-md);">
          <dt class="font-semibold text-base">K-Drama</dt>
          <dd class="text-sm mt-1" style="color: var(--md-color-on-surface-variant);">Serie de televisión producida en Corea del Sur, generalmente de 16-20 episodios con historia completa.</dd>
        </div>
        <div class="p-4" style="background-color: var(--md-color-surface-container); border-radius: var(--md-shape-md);">
          <dt class="font-semibold text-base">K-Pop</dt>
          <dd class="text-sm mt-1" style="color: var(--md-color-on-surface-variant);">Música pop coreana caracterizada por coreografías elaboradas, producción de alta calidad y grupos de idols.</dd>
        </div>
        <div class="p-4" style="background-color: var(--md-color-surface-container); border-radius: var(--md-shape-md);">
          <dt class="font-semibold text-base">Hallyu (한류)</dt>
          <dd class="text-sm mt-1" style="color: var(--md-color-on-surface-variant);">La "Ola Coreana", fenómeno global que incluye K-Pop, K-Dramas, cine, gastronomía y moda coreana.</dd>
        </div>
        <div class="p-4" style="background-color: var(--md-color-surface-container); border-radius: var(--md-shape-md);">
          <dt class="font-semibold text-base">Idol</dt>
          <dd class="text-sm mt-1" style="color: var(--md-color-on-surface-variant);">Artista de K-Pop entrenado por una agencia, que domina canto, baile y actuación tras años de preparación.</dd>
        </div>
        <div class="p-4" style="background-color: var(--md-color-surface-container); border-radius: var(--md-shape-md);">
          <dt class="font-semibold text-base">Hangul (한글)</dt>
          <dd class="text-sm mt-1" style="color: var(--md-color-on-surface-variant);">El alfabeto coreano, creado en 1443. Tiene 14 consonantes y 10 vocales, fácil de aprender en pocas horas.</dd>
        </div>
        <div class="p-4" style="background-color: var(--md-color-surface-container); border-radius: var(--md-shape-md);">
          <dt class="font-semibold text-base">OST</dt>
          <dd class="text-sm mt-1" style="color: var(--md-color-on-surface-variant);">Original Soundtrack, banda sonora de un K-Drama. Las canciones suelen ser éxitos y se lanzan durante la emisión.</dd>
        </div>
      </dl>

      <!-- Step-by-step Guide -->
      <h3 class="text-xl font-semibold mb-4" style="color: var(--md-color-on-surface);">
        ¿Cómo empezar a ver K-Dramas? Guía en 5 pasos
      </h3>
      <ol class="space-y-3 mb-6" style="max-width: 48rem;">
        <li class="flex gap-3 items-start">
          <span class="flex-shrink-0 w-7 h-7 rounded-full flex items-center justify-center text-sm font-bold" style="background-color: var(--md-color-primary); color: var(--md-color-on-primary);">1</span>
          <div>
            <strong style="color: var(--md-color-on-surface);">Elige una plataforma de streaming</strong>
            <p class="text-sm" style="color: var(--md-color-on-surface-variant);">Netflix tiene doblaje latino, Viki ofrece la mayor biblioteca con subtítulos.</p>
          </div>
        </li>
        <li class="flex gap-3 items-start">
          <span class="flex-shrink-0 w-7 h-7 rounded-full flex items-center justify-center text-sm font-bold" style="background-color: var(--md-color-primary); color: var(--md-color-on-primary);">2</span>
          <div>
            <strong style="color: var(--md-color-on-surface);">Comienza con dramas populares</strong>
            <p class="text-sm" style="color: var(--md-color-on-surface-variant);">Crash Landing on You, Goblin o El Juego del Calamar son excelentes para principiantes.</p>
          </div>
        </li>
        <li class="flex gap-3 items-start">
          <span class="flex-shrink-0 w-7 h-7 rounded-full flex items-center justify-center text-sm font-bold" style="background-color: var(--md-color-primary); color: var(--md-color-on-primary);">3</span>
          <div>
            <strong style="color: var(--md-color-on-surface);">Elige tu género favorito</strong>
            <p class="text-sm" style="color: var(--md-color-on-surface-variant);">Romance, thriller, fantasía, comedia... los K-Dramas cubren todos los géneros.</p>
          </div>
        </li>
        <li class="flex gap-3 items-start">
          <span class="flex-shrink-0 w-7 h-7 rounded-full flex items-center justify-center text-sm font-bold" style="background-color: var(--md-color-primary); color: var(--md-color-on-primary);">4</span>
          <div>
            <strong style="color: var(--md-color-on-surface);">Lee reseñas antes de ver</strong>
            <p class="text-sm" style="color: var(--md-color-on-surface-variant);">En OndaCoreana encontrarás reseñas sin spoilers para elegir tu próximo drama.</p>
          </div>
        </li>
        <li class="flex gap-3 items-start">
          <span class="flex-shrink-0 w-7 h-7 rounded-full flex items-center justify-center text-sm font-bold" style="background-color: var(--md-color-primary); color: var(--md-color-on-primary);">5</span>
          <div>
            <strong style="color: var(--md-color-on-surface);">Únete a la comunidad</strong>
            <p class="text-sm" style="color: var(--md-color-on-surface-variant);">Suscríbete a nuestro newsletter para recibir recomendaciones y novedades.</p>
          </div>
        </li>
      </ol>
    </div>
  </section>

  <!-- Ad: After Hero -->
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
    <AdSlot slot="home-hero-bottom" format="banner" testId="ad-home-hero" />
  </div>

  <!-- Últimas Noticias -->
  <section class="section-shell" style="--section-bg: var(--md-color-surface);">
    <div class="section-shell__inner">
      <div class="flex flex-wrap items-center justify-between gap-4">
        <div>
          <p class="chip" style="--chip-bg: color-mix(in srgb, var(--md-color-primary) 16%, transparent); --chip-color: var(--md-color-on-primary-container);">
            Noticias
          </p>
          <h2 class="text-3xl font-semibold" style="color: var(--md-color-on-surface); margin-top: var(--md-spacing-sm);">
            Últimas novedades
          </h2>
        </div>
        <a href="/noticias" class="btn btn--ghost">
          Ver todas →
        </a>
      </div>

      {recentNoticias.length > 0 ? (
        <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
          {recentNoticias.map((noticia) => (
            <article class="surface-card surface-card--interactive flex flex-col" style="padding: var(--md-spacing-md); overflow: hidden; background-color: var(--md-color-surface-container-low);">
              {noticia.data.heroImage && (
                <div class="mb-4">
                  <img
                    src={noticia.data.heroImage}
                    alt={noticia.data.heroImageAlt || noticia.data.title}
                    class="w-full object-cover"
                    style="border-radius: var(--md-shape-lg); height: 12rem;"
                    loading="lazy"
                  />
                </div>
              )}
              <div class="flex flex-wrap items-center gap-2">
                <span class="chip" style="--chip-bg: color-mix(in srgb, var(--md-color-primary) 15%, transparent); --chip-color: var(--md-color-on-primary-container);">
                  {noticia.data.category}
                </span>
                {noticia.data.breaking && (
                  <span class="chip" style="--chip-bg: var(--md-color-error); --chip-color: var(--md-color-on-error);">
                    Urgente
                  </span>
                )}
              </div>
              <h3 class="headline" style="margin-top: var(--md-spacing-sm); font-size: var(--md-typo-title-large-size);">
                <a href={`/noticias/${noticia.slug}`} style="color: var(--md-color-on-surface);">
                  {noticia.data.title}
                </a>
              </h3>
              <p class="subtle-text" style="margin-top: var(--md-spacing-xs);">
                {noticia.data.description}
              </p>
              <time
                datetime={noticia.data.pubDate.toISOString()}
                style="margin-top: var(--md-spacing-sm); font-size: var(--md-typo-label-medium-size); color: color-mix(in srgb, var(--md-color-on-surface-variant) 80%, transparent);"
              >
                {noticia.data.pubDate.toLocaleDateString('es-419', { year: 'numeric', month: 'long', day: 'numeric' })}
              </time>
            </article>
          ))}
        </div>
      ) : (
        <p class="text-center subtle-text">Próximamente: noticias sobre K-Dramas y K-Pop</p>
      )}
    </div>
  </section>

  <!-- Ad: Between Noticias and Dramas -->
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
    <AdSlot slot="home-mid-1" format="auto" testId="ad-home-mid-1" />
  </div>

  <!-- K-Dramas Destacados -->
  <section class="section-shell" style="--section-bg: var(--md-color-surface-container);">
    <div class="section-shell__inner">
      <div class="flex flex-wrap items-center justify-between gap-4">
        <div>
          <p class="chip" style="--chip-bg: color-mix(in srgb, var(--md-color-primary) 12%, var(--md-color-surface-container)); --chip-color: var(--md-color-on-surface);">
            Reseñas
          </p>
          <h2 class="text-3xl font-semibold" style="color: var(--md-color-on-surface); margin-top: var(--md-spacing-sm);">
            K-Dramas destacados
          </h2>
        </div>
        <a href="/dramas" class="btn btn--ghost">
          Ver todos →
        </a>
      </div>

      {recentDramas.length > 0 ? (
        <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-4">
          {recentDramas.map((drama) => (
            <ContentCard
              href={`/dramas/${drama.slug}`}
              title={drama.data.title}
              description={drama.data.description}
              heroImage={drama.data.heroImage}
              heroImageAlt={drama.data.heroImageAlt}
              imageHeight="16rem"
              descriptionClamp={2}
            >
              <Fragment slot="badges">
                {drama.data.genre?.slice(0, 2).map((g) => (
                  <span class="chip" style="--chip-bg: color-mix(in srgb, var(--md-color-primary) 10%, var(--md-color-surface-variant)); --chip-color: var(--md-color-on-surface);">
                    {g}
                  </span>
                ))}
              </Fragment>
              <Fragment slot="metadata">
                {drama.data.network && (
                  <p style="font-size: var(--md-typo-label-medium-size); color: color-mix(in srgb, var(--md-color-on-surface-variant) 80%, transparent);">
                    {drama.data.network}
                  </p>
                )}
              </Fragment>
            </ContentCard>
          ))}
        </div>
      ) : (
        <p class="text-center subtle-text">Próximamente: reseñas de los mejores K-Dramas</p>
      )}
    </div>
  </section>

  <!-- K-Pop -->
  <section class="section-shell" style="--section-bg: var(--md-color-surface);">
    <div class="section-shell__inner">
      <div class="flex flex-wrap items-center justify-between gap-4">
        <div>
          <p class="chip" style="--chip-bg: color-mix(in srgb, var(--md-color-tertiary) 18%, transparent); --chip-color: var(--md-color-on-tertiary-container);">
            K-Pop
          </p>
          <h2 class="text-3xl font-semibold" style="color: var(--md-color-on-surface); margin-top: var(--md-spacing-sm);">
            Escucha la nueva ola
          </h2>
        </div>
        <a href="/kpop" class="btn btn--ghost">
          Ver más →
        </a>
      </div>

      {recentKpop.length > 0 ? (
        <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-4">
          {recentKpop.map((artist) => (
            <article class="surface-card surface-card--interactive text-center" style="padding: var(--md-spacing-lg);">
              <div class="mx-auto h-40 w-40 rounded-full oc-card-shine" style="overflow: hidden; box-shadow: var(--md-elevation-2);">
                {artist.data.heroImage ? (
                  <img
                    src={artist.data.heroImage}
                    alt={artist.data.heroImageAlt || artist.data.artistName}
                    class="h-full w-full object-cover"
                    loading="lazy"
                  />
                ) : (
                  <div class="flex h-full w-full items-center justify-center" style="background: color-mix(in srgb, var(--md-color-tertiary) 25%, transparent); color: var(--md-color-on-tertiary-container); font-size: 2rem; font-weight: 700;">
                    {artist.data.artistName.charAt(0)}
                  </div>
                )}
              </div>
              <h3 class="mt-4 text-lg font-semibold" style="color: var(--md-color-on-surface);">
                <a href={`/kpop/${artist.slug}`}>
                  {artist.data.artistName}
                </a>
              </h3>
              {artist.data.agency && (
                <p class="subtle-text">{artist.data.agency}</p>
              )}
              <span class="chip" style="--chip-bg: color-mix(in srgb, var(--md-color-tertiary) 12%, transparent); --chip-color: var(--md-color-on-tertiary-container); margin-top: var(--md-spacing-sm); display: inline-flex; justify-content: center;">
                {artist.data.artistType}
              </span>
            </article>
          ))}
        </div>
      ) : (
        <p class="text-center subtle-text">Próximamente: perfiles de artistas K-Pop</p>
      )}
    </div>
  </section>

  <!-- Ad: Before FAQ -->
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
    <AdSlot slot="home-bottom" format="auto" testId="ad-home-bottom" />
  </div>

  <!-- FAQ Section for AEO -->
  <section class="section-shell" style="--section-bg: var(--md-color-surface-container);">
    <div class="section-shell__inner">
      <div class="mb-8">
        <p class="chip" style="--chip-bg: color-mix(in srgb, var(--md-color-primary) 12%, var(--md-color-surface-container)); --chip-color: var(--md-color-on-surface);">
          Ayuda
        </p>
        <h2 class="text-3xl font-semibold" style="color: var(--md-color-on-surface); margin-top: var(--md-spacing-sm);">
          Preguntas Frecuentes
        </h2>
      </div>
      <div class="faq-list" style="display: flex; flex-direction: column; gap: var(--md-spacing-md); max-width: 48rem;">
        {homepageFaq.map(({ question, answer }) => (
          <details
            class="faq-item"
            style="background-color: var(--md-sys-color-surface-variant); border-radius: var(--md-sys-shape-corner-medium); overflow: hidden;"
          >
            <summary
              class="faq-question"
              style="padding: var(--md-sys-spacing-md) var(--md-sys-spacing-lg); cursor: pointer; font-weight: 600; color: var(--md-sys-color-on-surface); display: flex; align-items: center; justify-content: space-between; gap: var(--md-sys-spacing-md);"
            >
              <span>{question}</span>
              <svg
                class="faq-icon"
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                style="flex-shrink: 0; transition: transform 0.2s ease;"
              >
                <polyline points="6 9 12 15 18 9" />
              </svg>
            </summary>
            <div
              class="faq-answer"
              style="padding: 0 var(--md-sys-spacing-lg) var(--md-sys-spacing-lg); color: var(--md-sys-color-on-surface-variant); line-height: 1.6;"
            >
              <p>{answer}</p>
            </div>
          </details>
        ))}
      </div>
    </div>
  </section>

  <!-- Newsletter CTA -->
  <section class="py-16">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <NewsletterForm variant="card" />
    </div>
  </section>
</BaseLayout>

<style>
  .faq-item[open] .faq-icon {
    transform: rotate(180deg);
  }
  .faq-item summary::-webkit-details-marker {
    display: none;
  }
  .faq-item summary::marker {
    display: none;
    content: '';
  }
  .faq-item summary:hover {
    background-color: color-mix(in srgb, var(--md-sys-color-on-surface) 5%, transparent);
  }
</style>
