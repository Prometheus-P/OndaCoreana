---
import BaseLayout from '../../layouts/BaseLayout.astro';
import AdSlot from '../../components/ads/AdSlot.astro';
import ContentCard from '../../components/ui/ContentCard.astro';
import FAQSection from '../../components/ui/FAQSection.astro';
import JsonLd from '../../components/seo/JsonLd.astro';
import { getPublishedContentSorted } from '../../utils/content-helpers';

const dramas = await getPublishedContentSorted('dramas');

// Insert ad after every N cards
const AD_INTERVAL = 4;

// FAQ data for AEO optimization - Magazine tone
const faqData = [
  {
    question: '¿Qué es un K-Drama?',
    answer: '¿Alguna vez lloraste a las 3am por personajes ficticios? Bienvenido al mundo de los K-Dramas. Son series coreanas que te atrapan con historias completas en 16-20 episodios, sin hacerte esperar años por un final. Tienen de todo: romances que te hacen suspirar, thrillers que no te dejan dormir, y fantasías que desearías fueran reales. La producción es cinematográfica, las bandas sonoras te persiguen por días, y la moda... prepárate para querer todo lo que usan los protagonistas.',
  },
  {
    question: '¿Cuántos episodios tiene un K-Drama típico?',
    answer: '¡Buenas noticias para tu vida social! La mayoría tiene 16-20 episodios de una hora cada uno. Eso significa que puedes terminar una historia completa en un par de semanas (o un fin de semana si eres como nosotros). Los mini-dramas son aún más cortos: 8-12 episodios perfectos para un maratón. Eso sí, cuidado con los sageuk (históricos) que pueden tener 50+ episodios... pero valen cada segundo.',
  },
  {
    question: '¿Dónde puedo ver K-Dramas con subtítulos en español?',
    answer: 'Netflix es el rey del catálogo con doblaje incluido, pero Viki es el tesoro escondido de los verdaderos fans: subtítulos hechos con amor por la comunidad y muchos títulos gratis. Disney+ está apostando fuerte con originales coreanos de alta calidad. Amazon Prime suma títulos cada mes. ¿Nuestro consejo? Empieza con la prueba gratis de cada uno y descubre cuál tiene TUS dramas favoritos. Spoiler: probablemente termines con todas.',
  },
  {
    question: '¿Cuáles son los K-Dramas más populares de todos los tiempos?',
    answer: '"El Juego del Calamar" rompió el internet y todos los récords de Netflix. "Crash Landing on You" es EL romance que convirtió a millones en fans. "Goblin" te hará creer en el amor eterno (literalmente). "Descendants of the Sun" tiene el romance militar más épico. Y "Reply 1988"... prepara los pañuelos porque vas a llorar de nostalgia por una época que ni viviste. Estos no son solo dramas, son experiencias que te cambian.',
  },
  {
    question: '¿Los K-Dramas tienen temporadas múltiples?',
    answer: 'Aquí viene lo mejor: la mayoría cuenta UNA historia completa. Nada de esperar años por respuestas o finales decepcionantes. Comienzas, te enamoras, lloras, y cierras el capítulo. Las excepciones son raras y solo para éxitos masivos como "El Juego del Calamar" o "Hospital Playlist". Esta estructura es parte de la magia: cada drama es una experiencia completa, no un compromiso de por vida.',
  },
  {
    question: '¿Qué géneros de K-Dramas existen?',
    answer: '¡Hay para todos los gustos! Romance (el favorito de millones), rom-coms que te hacen reír y suspirar, thrillers que te quitan el sueño, fantasía con goblin y sirenas, sageuk (históricos) con intrigas palaciegas y hanbok hermosos, médicos, legales, escolares... La magia es que casi todos tienen algo de romance. ¿Te gustan los zombies? Hay dramas. ¿Viajes en el tiempo? También. ¿Venganza empresarial? Por supuesto.',
  },
  {
    question: '¿Por qué los K-Dramas son tan adictivos?',
    answer: 'Confesamos: es casi imposible ver "solo un episodio". ¿Por qué? Cada episodio termina en un cliffhanger que te OBLIGA a continuar. La química entre protagonistas es eléctrica, el "slow burn" romántico te mantiene al borde del asiento, y las bandas sonoras te persiguen por semanas. Además, las historias tienen principio, desarrollo y final satisfactorio. Es entretenimiento diseñado para hacerte sentir TODO, y funciona demasiado bien.',
  },
  {
    question: '¿Necesito entender coreano para ver K-Dramas?',
    answer: '¡Para nada! Todos tienen subtítulos en español. Pero aquí viene lo divertido: después de unos cuantos dramas, vas a empezar a entender frases sin leer. "Saranghae" (te amo), "aigoo" (¡ay!), "daebak" (increíble), "fighting" (¡ánimo!)... De repente estás aprendiendo coreano sin darte cuenta. Muchos fans empezaron así su viaje con el idioma. ¿Quién dijo que ver TV no era educativo?',
  },
  {
    question: '¿Qué es un OST en K-Drama?',
    answer: 'OST = las canciones que te van a perseguir por MESES después de terminar un drama. Son bandas sonoras originales creadas específicamente para cada serie, y los artistas de K-Pop más famosos compiten por grabarlas. Cada escena romántica, cada momento de tensión, cada lágrima tiene su canción perfecta. Los fans coleccionamos estas playlists como tesoros. Advertencia: vas a escuchar "Stay With Me" de Goblin unas 500 veces.',
  },
  {
    question: '¿Qué significa "oppa" en los K-Dramas?',
    answer: '¡La palabra que vas a escuchar en CADA drama romántico! "Oppa" (오빠) es como las mujeres llaman a hombres mayores cercanos: hermanos, amigos, novios. Cuando la protagonista finalmente llama "oppa" al galán... es EL momento. También escucharás "unnie" (hermana mayor), "hyung" (hermano mayor entre hombres) y "noona" (mujer mayor, dicho por hombres). Dominar estos términos te hace oficialmente parte del fandom.',
  },
  {
    question: '¿Qué es un drama sageuk?',
    answer: 'Los sageuk son dramas históricos ambientados en la antigua Corea, principalmente la era Joseon. Imagina: palacios majestuosos, hanbok (vestimenta tradicional) espectaculares, intrigas políticas, romances prohibidos entre reyes y plebeyas, y escenas de artes marciales épicas. "Moon Lovers", "Mr. Sunshine" y "The Red Sleeve" son perfectos para empezar. Son como viajar en el tiempo, pero con mejor cinematografía y más drama amoroso.',
  },
  {
    question: '¿Qué es el "Second Lead Syndrome"?',
    answer: '¡El sufrimiento más dulce del mundo K-Drama! Es cuando te enamoras del segundo protagonista masculino... sabiendo que NO va a quedarse con la chica. Es más atento, más dulce, tiene mejor química con ella, PERO la historia ya decidió su destino. "Reply 1988", "Start-Up" y "True Beauty" son famosos por causar este síndrome. Los debates en redes son INTENSOS. Prepárate para sufrir y defender a tu favorito.',
  },
  {
    question: '¿Cuándo se estrenan nuevos K-Dramas?',
    answer: '¡Todo el año, bebé! No hay "temporadas" como en EE.UU. Cada semana hay estrenos nuevos, típicamente miércoles-jueves o sábados-domingos a las 22:00 hora de Corea. Netflix y Disney+ tienen sus propios calendarios. ¿Lo mejor? Los subtítulos en español suelen estar disponibles horas después del estreno. Nuestro consejo: sigue nuestras noticias para no perderte ningún estreno importante.',
  },
  {
    question: '¿Cómo se filman los K-Dramas?',
    answer: 'Aquí viene el dato que te va a impresionar: muchos K-Dramas se filman MIENTRAS se emiten. Se llama "live-shoot" y significa que los actores están grabando los episodios finales mientras tú ves los primeros. Esto permite ajustar la historia según las reacciones del público, pero los actores trabajan jornadas de 16+ horas. ¿El resultado? Actuaciones intensas y auténticas. Las producciones de Netflix suelen filmarse completas antes, pero el sistema tradicional sigue vivo.',
  },
  {
    question: '¿Qué K-Dramas son buenos para principiantes?',
    answer: '¡Te tenemos! Empieza con "Crash Landing on You" si quieres romance épico. "Goblin" si te gusta la fantasía con corazón. "Vincenzo" para acción con humor. "Hometown Cha-Cha-Cha" si prefieres algo ligero y adorable. "Strong Woman Do Bong Soon" combina comedia, romance y una protagonista que puede levantar autos. Todos tienen subtítulos excelentes y son perfectos para entender por qué millones estamos obsesionados con los K-Dramas.',
  },
];
---

<BaseLayout
  title="K-Dramas - Reseñas, Guías y Recomendaciones"
  description="Descubre los mejores K-Dramas con nuestras reseñas detalladas, guías de visualización y recomendaciones personalizadas. Todo en español."
>
  <Fragment slot="head">
    <JsonLd schema={{ type: 'FAQPage', questions: faqData }} />
  </Fragment>
  <section class="section-shell" style="--section-bg: linear-gradient(120deg, color-mix(in srgb, var(--md-color-primary) 80%, #0f0f0f) 0%, color-mix(in srgb, var(--md-color-tertiary) 60%, transparent) 100%); --section-color: var(--md-color-on-primary);">
    <div class="section-shell__inner">
      <h1 class="text-4xl font-bold" style="color: inherit;">K-Dramas</h1>
      <p style="color: color-mix(in srgb, var(--md-color-on-primary) 80%, transparent); max-width: 40rem;">
        Reseñas, guías y recomendaciones de los dramas coreanos que marcan tendencia.
      </p>
    </div>
  </section>

  <!-- Ad: Top of listing -->
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
    <AdSlot slot="dramas-top" format="banner" testId="ad-dramas-top" />
  </div>

  <section class="section-shell" style="--section-bg: var(--md-color-surface-container);">
    <div class="section-shell__inner">
      {dramas.length > 0 ? (
        <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4">
          {dramas.map((drama, index) => (
            <>
              <ContentCard
                href={`/dramas/${drama.slug}`}
                title={drama.data.title}
                description={drama.data.description}
                heroImage={drama.data.heroImage}
                heroImageAlt={drama.data.heroImageAlt}
                imageHeight="14rem"
              >
                <Fragment slot="badges">
                  {drama.data.genre?.slice(0, 2).map((g) => (
                    <span class="chip" style="--chip-bg: color-mix(in srgb, var(--md-color-primary) 12%, var(--md-color-surface-variant)); --chip-color: var(--md-color-on-surface);">
                      {g}
                    </span>
                  ))}
                </Fragment>
                <Fragment slot="metadata">
                  {drama.data.network && (
                    <p style="font-size: var(--md-typo-label-medium-size); color: color-mix(in srgb, var(--md-color-on-surface-variant) 80%, transparent);">
                      {drama.data.network}
                    </p>
                  )}
                </Fragment>
              </ContentCard>
              {/* Insert in-feed ad after every AD_INTERVAL cards */}
              {(index + 1) % AD_INTERVAL === 0 && index < dramas.length - 1 && (
                <div class="sm:col-span-2 lg:col-span-3 xl:col-span-4">
                  <AdSlot slot={`dramas-feed-${Math.floor(index / AD_INTERVAL)}`} format="in-feed" testId={`ad-dramas-feed-${index}`} />
                </div>
              )}
            </>
          ))}
        </div>
      ) : (
        <p class="text-center subtle-text">Próximamente: reseñas de los mejores K-Dramas</p>
      )}
    </div>
  </section>

  <!-- Ad: Bottom of listing -->
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 pb-8">
    <AdSlot slot="dramas-bottom" format="auto" testId="ad-dramas-bottom" />
  </div>

  <!-- Glossary Section for AEO -->
  <section class="section-shell" style="--section-bg: var(--md-color-surface);">
    <div class="section-shell__inner">
      <h2 class="text-2xl font-bold" style="color: var(--md-color-on-surface); margin-bottom: 1.5rem;">Glosario de Términos de K-Drama</h2>
      <dl class="grid gap-5 sm:grid-cols-2 lg:grid-cols-3">
        <div class="glossary-card">
          <dt class="glossary-term">Sageuk (사극)</dt>
          <dd class="glossary-def">Drama histórico ambientado en la era Joseon u otros períodos de la historia coreana. Incluye tramas políticas, romances de palacio y artes marciales.</dd>
        </div>
        <div class="glossary-card">
          <dt class="glossary-term">OST (Original Soundtrack)</dt>
          <dd class="glossary-def">Banda sonora original del drama. Las canciones son compuestas específicamente para la serie y suelen convertirse en hits musicales.</dd>
        </div>
        <div class="glossary-card">
          <dt class="glossary-term">Aegyo (애교)</dt>
          <dd class="glossary-def">Comportamiento tierno y adorable usado para expresar afecto. Común en escenas románticas de K-Dramas donde los personajes actúan de forma cute.</dd>
        </div>
        <div class="glossary-card">
          <dt class="glossary-term">Chaebol (재벌)</dt>
          <dd class="glossary-def">Heredero de un conglomerado empresarial coreano. Personaje típico en dramas románticos: rico, guapo y con conflictos familiares.</dd>
        </div>
        <div class="glossary-card">
          <dt class="glossary-term">Oppa (오빠)</dt>
          <dd class="glossary-def">Término que usan las mujeres para llamar a hombres mayores cercanos. En dramas románticos, indica cercanía emocional con el protagonista masculino.</dd>
        </div>
        <div class="glossary-card">
          <dt class="glossary-term">Second Lead Syndrome</dt>
          <dd class="glossary-def">Cuando los fans prefieren al segundo protagonista masculino sobre el principal. Fenómeno común que genera debates apasionados entre espectadores.</dd>
        </div>
      </dl>
    </div>
  </section>

  <style>
    .glossary-card {
      padding: 1.25rem;
      border-radius: 0.75rem;
      background: var(--md-color-surface-container-high);
      border: 1px solid var(--md-color-outline-variant);
      transition: box-shadow 0.2s ease, transform 0.2s ease;
    }
    .glossary-card:hover {
      box-shadow: var(--md-elevation-2);
      transform: translateY(-2px);
    }
    .glossary-term {
      font-weight: 600;
      font-size: 1.125rem;
      color: var(--md-color-primary);
      margin-bottom: 0.5rem;
    }
    .glossary-def {
      font-size: 0.875rem;
      line-height: 1.6;
      color: var(--md-color-on-surface-variant);
    }
  </style>

  <!-- FAQ Section for AEO -->
  <section class="section-shell" style="--section-bg: var(--md-color-surface-container-low);">
    <div class="section-shell__inner">
      <FAQSection questions={faqData} />
    </div>
  </section>
</BaseLayout>
