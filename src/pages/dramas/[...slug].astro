---
import { type CollectionEntry, getCollection } from 'astro:content';
import ArticleLayout from '../../layouts/ArticleLayout.astro';

export async function getStaticPaths() {
  const dramas = await getCollection('dramas');
  return dramas.map((drama) => ({
    params: { slug: drama.slug },
    props: drama,
  }));
}

type Props = CollectionEntry<'dramas'>;

const drama = Astro.props;
const { Content } = await drama.render();
---

<ArticleLayout
  title={drama.data.title}
  description={drama.data.description}
  pubDate={drama.data.pubDate}
  updatedDate={drama.data.updatedDate}
  heroImage={drama.data.heroImage}
  heroImageAlt={drama.data.heroImageAlt}
  author={drama.data.author}
  tags={drama.data.tags}
  breadcrumbs={[{ name: 'K-Dramas', url: '/dramas' }]}
  contentType="dramas"
  affiliateHint={drama.data.affiliate_hint}
  noAds={drama.data.noAds}
>
  <!-- Drama Info Box -->
  <aside class="not-prose mb-8 surface-card" style="background-color: var(--md-color-surface-container); padding: var(--md-spacing-lg);">
    <h2 class="text-lg font-semibold mb-4" style="color: var(--md-color-on-surface);">Información del Drama</h2>
    <dl class="grid grid-cols-2 gap-4 text-sm" style="color: var(--md-color-on-surface);">
      <div>
        <dt class="font-medium" style="color: var(--md-color-on-surface-variant);">Título Original</dt>
        <dd>{drama.data.dramaTitle}</dd>
      </div>
      {drama.data.dramaYear && (
        <div>
          <dt class="font-medium" style="color: var(--md-color-on-surface-variant);">Año</dt>
          <dd>{drama.data.dramaYear}</dd>
        </div>
      )}
      {drama.data.network && (
        <div>
          <dt class="font-medium" style="color: var(--md-color-on-surface-variant);">Cadena</dt>
          <dd>{drama.data.network}</dd>
        </div>
      )}
      {drama.data.episodes && (
        <div>
          <dt class="font-medium" style="color: var(--md-color-on-surface-variant);">Episodios</dt>
          <dd>{drama.data.episodes}</dd>
        </div>
      )}
      {drama.data.genre && drama.data.genre.length > 0 && (
        <div class="col-span-2">
          <dt class="font-medium" style="color: var(--md-color-on-surface-variant);">Géneros</dt>
          <dd>{drama.data.genre.join(', ')}</dd>
        </div>
      )}
      {drama.data.cast && drama.data.cast.length > 0 && (
        <div class="col-span-2">
          <dt class="font-medium" style="color: var(--md-color-on-surface-variant);">Reparto</dt>
          <dd>{drama.data.cast.join(', ')}</dd>
        </div>
      )}
      {drama.data.whereToWatch && drama.data.whereToWatch.length > 0 && (
        <div class="col-span-2">
          <dt class="font-medium" style="color: var(--md-color-on-surface-variant);">Dónde Ver</dt>
          <dd>{drama.data.whereToWatch.join(', ')}</dd>
        </div>
      )}
    </dl>
  </aside>

  <Content />
</ArticleLayout>
