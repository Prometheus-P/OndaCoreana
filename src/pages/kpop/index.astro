---
import BaseLayout from '../../layouts/BaseLayout.astro';
import AdSlot from '../../components/ads/AdSlot.astro';
import ContentCard from '../../components/ui/ContentCard.astro';
import FAQSection from '../../components/ui/FAQSection.astro';
import JsonLd from '../../components/seo/JsonLd.astro';
import { getPublishedContentSorted } from '../../utils/content-helpers';

const artists = await getPublishedContentSorted('kpop');

// Insert ad after every N cards
const AD_INTERVAL = 4;

// FAQ data for AEO optimization - Magazine tone
const faqData = [
  {
    question: '¿Qué significa K-Pop?',
    answer: 'K-Pop es mucho más que música: es un fenómeno global que combina pop, hip-hop, R&B y EDM con coreografías que desafían la gravedad y estéticas que cambian con cada comeback. Imagina artistas que cantan, bailan, rapean y actúan, todo después de años de entrenamiento intensivo. Es entretenimiento llevado a otro nivel, producido en Corea pero conquistando el mundo entero. Una vez que entras, no hay vuelta atrás.',
  },
  {
    question: '¿Cuáles son los grupos de K-Pop más famosos?',
    answer: 'BTS literalmente rompió todos los récords y llevó el K-Pop al mainstream global. BLACKPINK domina con estilo y actitud. SEVENTEEN tiene las mejores coreografías del juego. Stray Kids está conquistando el mundo con su sonido único. aespa mezcla K-Pop con universos virtuales. NewJeans refrescó todo el género. IVE, TWICE, NCT, TXT... la lista es interminable. ¿Lo mejor? Siempre hay un grupo perfecto para ti esperando ser descubierto.',
  },
  {
    question: '¿Qué es un idol de K-Pop?',
    answer: 'Un idol es básicamente un superhéroe del entretenimiento. Entrenan 2-7 años ANTES de debutar, aprendiendo canto, baile, rap, actuación, idiomas... todo. Después del debut, hacen música, protagonizan dramas, conducen programas de variedades, y mantienen una conexión cercana con sus fans a través de lives y fan meetings. Son artistas completos con una dedicación que te deja sin palabras. Y sí, muchos empezaron siendo adolescentes.',
  },
  {
    question: '¿Cómo se llaman los fans de K-Pop?',
    answer: '¡Cada fandom tiene su nombre y ORGULLO! ARMY (BTS), BLINK (BLACKPINK), ONCE (TWICE), STAY (Stray Kids), MY (aespa), CARAT (SEVENTEEN)... Ser parte de un fandom es pertenecer a una comunidad global que vota junta, hace streaming coordinado, organiza proyectos de cumpleaños épicos, y defiende a sus artistas con pasión. Cada fandom tiene su color oficial, su lightstick, y sus tradiciones. Es familia.',
  },
  {
    question: '¿Qué es un comeback en K-Pop?',
    answer: '¡El evento más emocionante del calendario fan! Un comeback es cuando tu grupo vuelve con música nueva después de meses de silencio. Pero no es solo música: es un concepto visual completamente nuevo, teasers que te vuelven loco, fotos que rompen internet, videoclips con producción de película, y semanas de promociones en programas musicales. Los fandoms se preparan como para una guerra (de streams y votos). La adrenalina es REAL.',
  },
  {
    question: '¿Dónde puedo escuchar K-Pop?',
    answer: 'Spotify y Apple Music tienen casi todo, pero YouTube es donde vive la magia: videoclips épicos, performances, behind-the-scenes. Weverse es la app donde los idols de HYBE postean y chatean con fans. Para los más dedicados, las plataformas coreanas como Melon importan para los charts. Nuestro consejo: empieza por YouTube, enamórate de un grupo, y luego explora TODO su contenido. Hay años de material esperándote.',
  },
  {
    question: '¿Qué agencias de K-Pop son las más importantes?',
    answer: 'Las "Big 4" son como los Avengers del K-Pop. HYBE (BTS, SEVENTEEN, NewJeans) es la más grande y poderosa. SM Entertainment (aespa, NCT) es la pionera que inventó el sistema idol. JYP Entertainment (Stray Kids, TWICE) es conocida por formar artistas carismáticos. YG Entertainment (BLACKPINK) tiene el estilo más hip-hop y cool. Cada agencia tiene su "sonido" distintivo. Los fans pueden identificar de qué agencia es un grupo solo escuchando.',
  },
  {
    question: '¿Cómo apoyar a mi grupo favorito de K-Pop?',
    answer: '¡Tu apoyo IMPORTA y se mide! Streaming en plataformas oficiales cuenta para charts. Los álbumes físicos impulsan las ventas. Votar en programas musicales puede darles su primer #1 (momento ÉPICO). Comprar merchandise oficial apoya directamente al grupo. Crear contenido positivo expande el fandom. Lo más importante: disfruta genuinamente de su música. Evita piratería porque daña directamente a los artistas que amas.',
  },
  {
    question: '¿Qué es un lightstick en K-Pop?',
    answer: '¡El símbolo máximo de pertenencia a un fandom! Cada grupo tiene su lightstick único: el ARMY Bomb de BTS es legendario, el Hammer de BLACKPINK es icónico, el Candybong de TWICE es adorable. En conciertos, MILES de lightsticks se sincronizan por Bluetooth para crear océanos de luz coordinados con la música. Es uno de los momentos más mágicos que puedes experimentar. Tener el lightstick de tu grupo es un rito de iniciación.',
  },
  {
    question: '¿Qué son los programas musicales de K-Pop?',
    answer: 'Son shows semanales donde los grupos promocionan sus canciones y compiten por el codiciado #1. M Countdown, Music Bank, Inkigayo... cada uno tiene su día. Ganar un "music show win" es un logro ENORME, especialmente el primero. Los grupos lloran, los fans lloran, todos lloran. Los fandoms se organizan para votar y hacer streaming coordinado. Es emocionante, dramático, y una parte esencial de la experiencia K-Pop.',
  },
  {
    question: '¿Qué significa "bias" en K-Pop?',
    answer: '¡Tu bias es tu miembro favorito y es SAGRADO! Pero cuidado con los "bias wreckers": otros miembros que amenazan con robarte el corazón cuando menos lo esperas. Tu "ultimate bias" es tu favorito entre TODOS los idols. Elegir bias es difícil, cambiar de bias causa crisis existenciales, y tener múltiples biases es perfectamente válido. Es parte de la diversión. ¿Ya sabes quién es el tuyo?',
  },
  {
    question: '¿Qué es un trainee de K-Pop?',
    answer: 'El camino al debut es BRUTAL. Los trainees entrenan 10-16 horas diarias durante años: clases de canto, baile, rap, actuación, idiomas, composición, hasta etiqueta pública. Las evaluaciones mensuales determinan quién sigue y quién se va. Muchos empiezan a los 12-14 años. Solo una fracción debuta. Los programas de supervivencia como "Produce 101" mostraron al mundo esta realidad. Cuando ves a un idol en escenario, estás viendo años de sacrificio.',
  },
  {
    question: '¿Qué son las photocards en K-Pop?',
    answer: '¡La obsesión más adorable del fandom! Son tarjetitas coleccionables incluidas ALEATORIAMENTE en álbumes. Conseguir la photocard de tu bias es como ganar la lotería. No conseguirla significa comprar más álbumes o entrar al intenso mundo del trading. Las "POBs" (beneficios de pre-orden) de tiendas específicas son aún más raras y valiosas. Hay fans con colecciones de cientos. Es adictivo, caro, y absolutamente parte de la experiencia.',
  },
  {
    question: '¿Cuál es la diferencia entre mini álbum y álbum completo?',
    answer: 'Mini álbum (EP): 4-7 canciones, el formato más común, lanzado cada 4-6 meses. Álbum completo: 10+ canciones, menos frecuente, representa un proyecto más ambicioso y artístico. Single álbum: 1-3 canciones para promociones rápidas. Repackage: el mismo álbum con canciones extra. ¿Lo divertido? Cada formato viene en MÚLTIPLES versiones con fotos conceptuales diferentes. Sí, los fans compran varias versiones. No preguntes cuántas.',
  },
  {
    question: '¿Cómo funcionan los charts de K-Pop?',
    answer: 'Es una CIENCIA. Melon, Genie, Bugs dominan el streaming coreano. Billboard mide el impacto global. Hanteo y Circle Chart cuentan ventas físicas. Un "all-kill" es cuando tu artista es #1 en TODOS los charts simultáneamente: momento de celebración máxima. Las ventas de primera semana son métricas de poder. Los fandoms coordinan streams a horas específicas para maximizar impacto. Es competitivo, emocionante, y los números se celebran como victorias.',
  },
];
---

<BaseLayout
  title="K-Pop - Artistas, Grupos y Noticias"
  description="Todo sobre K-Pop en español: perfiles de artistas, grupos, comebacks, noticias y más. Tu guía completa del mundo del K-Pop."
>
  <Fragment slot="head">
    <JsonLd schema={{ type: 'FAQPage', questions: faqData }} />
  </Fragment>
  <section class="section-shell" style="--section-bg: linear-gradient(140deg, color-mix(in srgb, var(--md-color-tertiary) 90%, #0d0d0d) 0%, color-mix(in srgb, var(--md-color-primary) 70%, transparent) 100%); --section-color: var(--md-color-on-primary);">
    <div class="section-shell__inner">
      <h1 class="text-4xl font-bold" style="color: inherit;">K-Pop</h1>
      <p style="color: color-mix(in srgb, var(--md-color-on-primary) 80%, transparent); max-width: 40rem;">
        Artistas, grupos, comebacks y movimientos de la industria musical coreana.
      </p>
    </div>
  </section>

  <!-- Ad: Top of listing -->
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
    <AdSlot slot="kpop-top" format="banner" testId="ad-kpop-top" />
  </div>

  <section class="section-shell" style="--section-bg: var(--md-color-surface);">
    <div class="section-shell__inner">
      {artists.length > 0 ? (
        <div class="grid gap-8 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4">
          {artists.map((artist, index) => (
            <>
              <ContentCard
                href={`/kpop/${artist.slug}`}
                title={artist.data.artistName}
                heroImage={artist.data.heroImage}
                heroImageAlt={artist.data.heroImageAlt}
                variant="kpop-artist"
              >
                <Fragment slot="subtitle">
                  {artist.data.agency && (
                    <p class="subtle-text">{artist.data.agency}</p>
                  )}
                </Fragment>
                <Fragment slot="badges">
                  <span class="chip" style="--chip-bg: color-mix(in srgb, var(--md-color-tertiary) 15%, transparent); --chip-color: var(--md-color-on-tertiary-container);">
                    {artist.data.artistType}
                  </span>
                </Fragment>
              </ContentCard>
              {/* Insert in-feed ad after every AD_INTERVAL cards */}
              {(index + 1) % AD_INTERVAL === 0 && index < artists.length - 1 && (
                <div class="sm:col-span-2 lg:col-span-3 xl:col-span-4">
                  <AdSlot slot={`kpop-feed-${Math.floor(index / AD_INTERVAL)}`} format="in-feed" testId={`ad-kpop-feed-${index}`} />
                </div>
              )}
            </>
          ))}
        </div>
      ) : (
        <p class="text-center subtle-text">Próximamente: perfiles de artistas y grupos K-Pop</p>
      )}
    </div>
  </section>

  <!-- Ad: Bottom of listing -->
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 pb-8">
    <AdSlot slot="kpop-bottom" format="auto" testId="ad-kpop-bottom" />
  </div>

  <!-- Glossary Section for AEO -->
  <section class="section-shell" style="--section-bg: var(--md-color-surface);">
    <div class="section-shell__inner">
      <h2 class="text-2xl font-bold" style="color: var(--md-color-on-surface); margin-bottom: 1.5rem;">Glosario de Términos de K-Pop</h2>
      <dl class="grid gap-5 sm:grid-cols-2 lg:grid-cols-3">
        <div class="glossary-card">
          <dt class="glossary-term">Idol (아이돌)</dt>
          <dd class="glossary-def">Artista de K-Pop entrenado profesionalmente por una agencia. Domina canto, baile, rap y actuación. Mantiene una imagen pública cuidada y conexión cercana con fans.</dd>
        </div>
        <div class="glossary-card">
          <dt class="glossary-term">Comeback (컴백)</dt>
          <dd class="glossary-def">Regreso de un artista con nuevo álbum y promociones. Incluye concepto visual, videoclip, coreografía y presentaciones en programas musicales.</dd>
        </div>
        <div class="glossary-card">
          <dt class="glossary-term">Bias (최애)</dt>
          <dd class="glossary-def">Miembro favorito de un grupo. "Bias wrecker" es otro miembro que amenaza con convertirse en tu nuevo favorito por su carisma.</dd>
        </div>
        <div class="glossary-card">
          <dt class="glossary-term">Fandom (팬덤)</dt>
          <dd class="glossary-def">Comunidad organizada de fans con nombre oficial. Ejemplos: ARMY (BTS), BLINK (BLACKPINK), ONCE (TWICE). Apoyan con streaming, votaciones y proyectos.</dd>
        </div>
        <div class="glossary-card">
          <dt class="glossary-term">Lightstick (응원봉)</dt>
          <dd class="glossary-def">Bastón luminoso oficial de cada grupo usado en conciertos. Diseño único que identifica al fandom y se sincroniza con la música durante shows.</dd>
        </div>
        <div class="glossary-card">
          <dt class="glossary-term">Trainee (연습생)</dt>
          <dd class="glossary-def">Aprendiz que entrena en una agencia antes de debutar. El período puede durar de 2 a 7 años, practicando canto, baile, idiomas y habilidades de entretenimiento.</dd>
        </div>
      </dl>
    </div>
  </section>

  <style>
    .glossary-card {
      padding: 1.25rem;
      border-radius: 0.75rem;
      background: var(--md-color-surface-container-high);
      border: 1px solid var(--md-color-outline-variant);
      transition: box-shadow 0.2s ease, transform 0.2s ease;
    }
    .glossary-card:hover {
      box-shadow: var(--md-elevation-2);
      transform: translateY(-2px);
    }
    .glossary-term {
      font-weight: 600;
      font-size: 1.125rem;
      color: var(--md-color-tertiary);
      margin-bottom: 0.5rem;
    }
    .glossary-def {
      font-size: 0.875rem;
      line-height: 1.6;
      color: var(--md-color-on-surface-variant);
    }
  </style>

  <!-- FAQ Section for AEO -->
  <section class="section-shell" style="--section-bg: var(--md-color-surface-container-low);">
    <div class="section-shell__inner">
      <FAQSection questions={faqData} />
    </div>
  </section>
</BaseLayout>
